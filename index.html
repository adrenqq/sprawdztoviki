<script>
  const yes = document.getElementById("yes");
  const no = document.getElementById("no");
  const result = document.getElementById("result");
  const arena = document.getElementById("arena");

  // --- Make sure arena is a positioning container ---
  arena.style.position = "relative";
  arena.style.height = "90px";

  // --- Place NO button initially inside arena ---
  no.style.position = "absolute";
  no.style.left = "65%";
  no.style.top = "50%";
  no.style.transform = "translate(-50%, -50%)";

  // ---- SAVE ANSWER (localStorage) ----
  const KEY = "valentine_answer_v1";
  const saved = (() => { try { return JSON.parse(localStorage.getItem(KEY)); } catch { return null; } })();
  if (saved?.answer) result.textContent = `Zapisane: ${saved.answer} âœ…`;

  function setAnswer(ans){
    localStorage.setItem(KEY, JSON.stringify({ answer: ans, time: new Date().toISOString() }));
  }

  // ---- YES ----
  yes.addEventListener("click", () => {
    setAnswer("TAK ğŸ’–");
    result.textContent = "YAY! ğŸ’˜ Widzimy siÄ™ na Walentynki ğŸ˜„";
  });

  // ---- NO ESCAPE ----
  let escapes = 0;
  const noTexts = [
    "NIE ğŸ˜ˆ", "Nie da siÄ™ ğŸ˜", "Oj prawie! ğŸ˜…", "ZÅ‚a odpowiedÅº ğŸ˜Œ",
    "Kliknij TAK ğŸ˜‡", "PrzestaÅ„ mnie goniÄ‡ ğŸ˜‚"
  ];

  function moveNoButton(){
    const rect = arena.getBoundingClientRect();
    const btn = no.getBoundingClientRect();

    const pad = 6;
    const maxX = rect.width - btn.width - pad;
    const maxY = rect.height - btn.height - pad;

    const x = pad + Math.random() * Math.max(1, maxX);
    const y = pad + Math.random() * Math.max(1, maxY);

    no.style.left = `${x}px`;
    no.style.top  = `${y}px`;
    no.style.transform = "translate(0, 0)";

    escapes++;
    no.textContent = noTexts[escapes % noTexts.length];
  }

  // 1) Normal hover
  no.addEventListener("mouseenter", moveNoButton);

  // 2) If mouse gets close to the NO button (stronger effect)
  arena.addEventListener("mousemove", (e) => {
    const a = arena.getBoundingClientRect();
    const bx = parseFloat(no.style.left) || a.width * 0.65;
    const by = parseFloat(no.style.top)  || a.height * 0.5;

    const mx = e.clientX - a.left;
    const my = e.clientY - a.top;

    const dist = Math.hypot(mx - bx, my - by);

    // If cursor within ~90px, escape
    if (dist < 90) moveNoButton();
  });

  // 3) Mobile / touch
  no.addEventListener("touchstart", (e) => {
    e.preventDefault();
    moveNoButton();
  }, { passive: false });

  // 4) If she somehow clicks it
  no.addEventListener("click", (e) => {
    e.preventDefault();
    moveNoButton(); // still escape
    setAnswer("NIE ğŸ˜ˆ");
    result.textContent = "Zapisane: NIEâ€¦ ale ja i tak wiem, Å¼e to â€TAKâ€ ğŸ˜„";


